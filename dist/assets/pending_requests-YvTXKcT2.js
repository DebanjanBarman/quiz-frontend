import{q as I,s as G,r as g,o as O,b as i,c as N,d as a,w as t,u as r,v as b,e as h,f as y,F as q,i as d,B as D,x as L,j as l,h as E,t as C}from"./index-DFaQB4TW.js";import{_ as U,V as F,e as j}from"./AppBar-BlsIPLEh.js";import{a as w,b as v}from"./index-BUGHhKDO.js";import{l as M}from"./index-NsU1tN7b.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Q}from"./VDialog-7I16u2be.js";import{V as m}from"./VContainer-BKiY6asd.js";import{V as B}from"./VRow-CmtNopeS.js";import{V as k}from"./VCol-BY8alMtX.js";import{V}from"./forwardRefs-NMVkxSyT.js";import{V as H}from"./VCardTitle-D_LrLyCz.js";import{V as J}from"./VForm-DCAA8DGj.js";import{V as K}from"./VTextField-T0dUUG24.js";import{a as W,V as X}from"./VDataTable-BDgtr2mz.js";import"./VInput-C4PcMeCu.js";import"./filter--VPLo0fP.js";import"./VSelectionControl-CXhdLfDS.js";import"./VChip-DVI_L7N4.js";const Y={__name:"pending_requests",setup(Z){const n=I(),u=G().params.id,c=g([]),_=g([]),p=g(!1),T=g(!1),f=g(5),x=M(w.baseURL);x.on("connect",()=>{console.log(x.id)});async function A(){await n.push(`/admin/${u}`)}async function R(o){try{const e=await v.post(`${w.accept_join_req}`,{user_id:o,quiz_id:u},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});await S(),await $()}catch(e){console.log(e),e.status===401?(console.log("NOT LOGGED IN"),localStorage.clear(),await n.push("/login")):(alert("Something went wrong, redirecting to home"),await n.push("/"))}}async function S(){try{const o=await v.get(`${w.pending_req}/${u}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});c.value=o.data.data}catch(o){console.log(o),o.status===401?(console.log("NOT LOGGED IN"),localStorage.clear(),await n.push("/login")):(alert("Something went wrong, redirecting to home"),await n.push("/"))}}async function $(){try{let e=(await v.get(`${w.result}/accepted-users/${u}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).data.data;_.value=e,console.log(e)}catch(o){console.log(o),o.status===401&&(console.log("NOT LOGGED IN"),localStorage.clear(),await n.push("/login"))}}async function z(){console.log(f.value,u);try{const o=await v.post(`${w.start_quiz}/${u}`,{time:f.value},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});console.log(c.data),p.value=!1}catch(o){console.log(o),o.status===401?(console.log("NOT LOGGED IN"),localStorage.clear(),await n.push("/login")):(alert("Something went wrong, redirecting to home"),await n.push("/"))}}return x.on("new-join-request",async o=>{await S(),await $()}),O(async()=>{await S(),await $()}),(o,e)=>(i(),N(q,null,[a(U),a(Q,{modelValue:r(p),"onUpdate:modelValue":e[2]||(e[2]=s=>b(p)?p.value=s:null),"max-width":"400",persistent:""},{activator:t(({props:s})=>[a(m,null,{default:t(()=>[a(B,{class:"mx-4 my-3",style:{border:"1px solid #fdf","border-radius":"1rem"}},{default:t(()=>[a(k,{cols:"3"},{default:t(()=>[a(V,{style:{float:"left"},"prepend-icon":"mdi-arrow-left",variant:"outlined",color:"purple",onClick:A},{default:t(()=>e[3]||(e[3]=[d(" Back ")])),_:1})]),_:1}),a(k,{cols:"3"},{default:t(()=>[a(V,D({variant:"outlined",color:"green"},s),{default:t(()=>e[4]||(e[4]=[d(" Start Quiz ")])),_:2},1040)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),default:t(()=>[a(m,null,{default:t(()=>[a(B,null,{default:t(()=>[a(k,null,{default:t(()=>[a(F,{class:"pa-8"},{default:t(()=>[a(H,null,{default:t(()=>e[5]||(e[5]=[d("Set the Time")])),_:1}),a(k,{style:{"max-width":"500px",margin:"auto"},cols:"12"},{default:t(()=>[a(J,{onSubmit:L(z,["prevent"])},{default:t(()=>[a(K,{modelValue:r(f),"onUpdate:modelValue":e[0]||(e[0]=s=>b(f)?f.value=s:null),variant:"outlined",density:"compact",label:"Time in minutes"},null,8,["modelValue"]),a(j,null,{default:t(()=>[a(V,{onClick:e[1]||(e[1]=s=>p.value=!1),variant:"outlined",color:"warning"},{default:t(()=>e[6]||(e[6]=[d("Cancel")])),_:1}),a(V,{loading:r(T),type:"submit",variant:"outlined",color:"success"},{default:t(()=>e[7]||(e[7]=[d("Start")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(c).length===0?(i(),h(m,{key:0},{default:t(()=>e[8]||(e[8]=[l("div",{class:"no_req"},[l("h3",null," New Requests will appear here ")],-1)])),_:1})):y("",!0),r(_).length===0?(i(),h(m,{key:1},{default:t(()=>e[9]||(e[9]=[l("div",{class:"no_req"},[l("h3",null," Accepted Requests will appear here ")],-1)])),_:1})):y("",!0),a(m,null,{default:t(()=>[r(c).length>0?(i(),h(W,{key:0,"fixed-header":"",height:"300px"},{default:t(()=>[e[11]||(e[11]=l("thead",null,[l("tr",null,[l("th",{class:"text-left"}," Name "),l("th",{class:"text-left"}," Email "),l("th",{class:"text-left"}," Accept ")])],-1)),l("tbody",null,[(i(!0),N(q,null,E(r(c),s=>(i(),N("tr",{key:s.id},[l("td",null,C(s.user_name),1),l("td",null,C(s.email),1),l("td",null,[a(V,{color:"green",variant:"flat",onClick:te=>R(s.user_id)},{default:t(()=>e[10]||(e[10]=[d("Accept")])),_:2},1032,["onClick"])])]))),128))])]),_:1})):y("",!0)]),_:1}),r(_).length>0?(i(),h(m,{key:2},{default:t(()=>[e[12]||(e[12]=l("h3",{style:{"max-width":"40rem",margin:"auto auto 1rem"}},"Accepted Users",-1)),a(X,{items:r(_),style:{"max-width":"40rem",margin:"auto"}},null,8,["items"])]),_:1})):y("",!0)],64))}},ye=P(Y,[["__scopeId","data-v-b3902cfc"]]);export{ye as default};
